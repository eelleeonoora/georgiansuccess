<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sign Up - Business</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      color: #333;
    }

    header {
      background-color: white;
      border-bottom: 1px solid #ccc;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-section img {
      height: 50px;
    }

    nav {
      display: flex;
      gap: 20px;
      background-color: white;
    }

    nav a {
      text-decoration: none;
      color: #9f1a1a;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 4px;
    }

    nav a:hover {
      background-color: #f5dede;
    }

    .container {
      max-width: 500px;
      margin: 30px auto;
      padding: 0 15px;
    }

    form {
      border: 1px solid #ccc;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 0 8px #aaa;
      background-color: #fff;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    label {
      display: block;
      margin-top: 15px;
      color: #9f1a1a;
      font-weight: 600;
    }

    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="date"],
    input[type="tel"],
    input[type="url"],
    select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      box-sizing: border-box;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }

    button {
      margin-top: 20px;
      padding: 12px;
      width: 100%;
      background-color: #9f1a1a;
      color: white;
      border: none;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #7a1414;
    }

    #zoomField {
      display: none;
    }

    .error {
      color: red;
      font-size: 0.9em;
      margin-top: 3px;
    }

    .success {
      color: green;
      font-size: 1em;
      margin-top: 15px;
      text-align: center;
    }

    .login-link {
      text-align: center;
      margin-top: 15px;
    }

    .login-link a {
      color: #007BFF;
      text-decoration: none;
    }
  </style>
</head>
<body>

  <header>
    <div class="logo-section">
      <a href="index.html"><img src="logo.png" alt="Logo" /></a>
    </div>
    <nav id="nav-links">
      <a href="businesses.html">Businesses</a>
      <a href="courses.html">English Hub</a>
      <a href="signup-choice.html">Sign Up</a>
      <a href="login.html">Login</a>
    </nav>
  </header>

  <div class="container">
    <h1 style="color: #9f1a1a;">Sign Up as Business</h1>
    <form id="signupForm" autocomplete="off">
      <label for="firstName">First Name*</label>
      <input type="text" id="firstName" name="firstName" required />

      <label for="lastName">Last Name*</label>
      <input type="text" id="lastName" name="lastName" required />

      <label for="email">Email*</label>
      <input type="email" id="email" name="email" required />

      <label for="password">Password* (Min 6 chars, 1 uppercase, 1 number)</label>
      <input type="password" id="password" name="password" required />

      <label for="birthDate">Birthdate*</label>
      <input type="date" id="birthDate" name="birthDate" required />

      <label for="country">Country*</label>
      <select id="country" name="country" required>
        <option value="">Select Country</option>
        <option value="USA">USA</option>
        <option value="Georgia">Georgia</option>
      </select>

      <label for="state">State*</label>
      <select id="state" name="state" required>
        <option value="">Select State</option>
      </select>

      <label for="phone">Phone Number*</label>
      <input type="tel" id="phone" name="phone" required />

      <label for="category">Category*</label>
      <select id="category" name="category" required>
        <option value="">-- Select Category --</option>
        <option value="teachers">Teacher</option>
        <option value="lawyers">Lawyer</option>
        <option value="consultants">Consultant</option>
      </select>

      <div id="zoomField">
        <label for="zoomLink">Zoom Link (for Teachers only)*</label>
        <input type="url" id="zoomLink" name="zoomLink" placeholder="Zoom Link (for Teachers only)" />
      </div>

      <button type="submit">Sign Up</button>
    </form>

    <div id="message"></div>

    <p class="login-link">Already have an account? <a href="login.html">Log In</a></p>
  </div>

  <!-- Firebase + Dynamic States + Form Logic -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
    import {
      getAuth,
      createUserWithEmailAndPassword,
      sendEmailVerification
    } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
    import {
      getFirestore,
      doc,
      setDoc
    } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDHl-WeXRfbkxP3npd_5Xb4U0I9lcPqUEg",
      authDomain: "mywebsitesignup-671f5.firebaseapp.com",
      projectId: "mywebsitesignup-671f5",
      storageBucket: "mywebsitesignup-671f5.appspot.com",
      messagingSenderId: "418016210554",
      appId: "1:418016210554:web:4a4f81aa4f5be22868d5c3"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const usaStates = [
      "Alabama", "Alaska", "Arizona", "Arkansas", "California", "Colorado", "Connecticut", "Delaware",
      "Florida", "Georgia", "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Kansas", "Kentucky",
      "Louisiana", "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota", "Mississippi",
      "Missouri", "Montana", "Nebraska", "Nevada", "New Hampshire", "New Jersey", "New Mexico",
      "New York", "North Carolina", "North Dakota", "Ohio", "Oklahoma", "Oregon", "Pennsylvania",
      "Rhode Island", "South Carolina", "South Dakota", "Tennessee", "Texas", "Utah", "Vermont",
      "Virginia", "Washington", "West Virginia", "Wisconsin", "Wyoming"
    ];

    const georgiaStates = [
      "Tbilisi", "Kutaisi", "Batumi", "Rustavi", "Zugdidi", "Poti", "Gori", "Telavi", "Samtredia", "Senaki"
    ];

    const countryDropdown = document.getElementById("country");
    const stateDropdown = document.getElementById("state");

    countryDropdown.addEventListener("change", () => {
      const selectedCountry = countryDropdown.value;
      stateDropdown.innerHTML = '<option value="">Select State</option>';

      let states = [];
      if (selectedCountry === "USA") states = usaStates;
      else if (selectedCountry === "Georgia") states = georgiaStates;

      states.forEach(state => {
        const option = document.createElement("option");
        option.value = state;
        option.textContent = state;
        stateDropdown.appendChild(option);
      });
    });

    const categorySelect = document.getElementById("category");
    const zoomField = document.getElementById("zoomField");
    const zoomLinkInput = document.getElementById("zoomLink");

    categorySelect.addEventListener("change", () => {
      if (categorySelect.value === "teachers") {
        zoomField.style.display = "block";
        zoomLinkInput.required = true;
      } else {
        zoomField.style.display = "none";
        zoomLinkInput.required = false;
        zoomLinkInput.value = "";
      }
    });

    const form = document.getElementById("signupForm");
    const messageDiv = document.getElementById("message");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      messageDiv.textContent = "";
      messageDiv.className = "";

      const firstName = form.firstName.value.trim();
      const lastName = form.lastName.value.trim();
      const email = form.email.value.trim();
      const password = form.password.value;
      const birthDate = form.birthDate.value;
      const country = form.country.value;
      const state = form.state.value;
      const phone = form.phone.value.trim();
      const category = form.category.value;
      const zoomLink = zoomLinkInput.value.trim();

      if (!category) {
        messageDiv.textContent = "Please select a category.";
        messageDiv.className = "error";
        return;
      }

      if (category === "teachers" && !zoomLink) {
        messageDiv.textContent = "Please enter your Zoom link.";
        messageDiv.className = "error";
        return;
      }

      if (password.length < 6 || !/[A-Z]/.test(password) || !/\d/.test(password)) {
        messageDiv.textContent = "Password must have 6+ chars, 1 uppercase letter, and 1 number.";
        messageDiv.className = "error";
        return;
      }

      try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        const uid = userCredential.user.uid;

        const userData = {
          firstName,
          lastName,
          email,
          birthDate,
          country,
          state,
          phone,
          category,
          createdAt: new Date().toISOString()
        };

        if (category === "teachers") {
          userData.zoomLink = zoomLink;
          userData.studentsAssigned = [];
        }

        await setDoc(doc(db, category, uid), userData);
        await sendEmailVerification(userCredential.user);

        messageDiv.textContent = "Sign up successful! Please verify your email.";
        messageDiv.className = "success";
        form.reset();
        zoomField.style.display = "none";

      } catch (error) {
        messageDiv.textContent = "Error: " + error.message;
        messageDiv.className = "error";
      }
    });
  </script>

  <!-- Font Awesome for social icons -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  />

  <footer class="site-footer" style="background-color: #000; color: white; padding: 30px 20px; margin-top: 40px;">
    <div class="footer-container" style="display: flex; flex-wrap: wrap; justify-content: space-between;">
      <div class="footer-left" style="margin-bottom: 20px;">
        <h3 style="color: white;">Contact</h3>
        <p>
          <a href="http://wa.me/13103455780" target="_blank" style="color: white; text-decoration: none;">
            <i class="fab fa-whatsapp" style="margin-right: 8px;"></i>Chat with us
          </a>
        </p>
      </div>
      <div class="footer-right" style="margin-bottom: 20px;">
        <h3 style="color: white;">Follow Us</h3>
        <a href="https://www.facebook.com/GeorgianSuccessAmerica?mibextid=wwXIfr" target="_blank" style="color: white; text-decoration: none;">
          <i class="fab fa-facebook" style="margin-right: 8px;"></i>Facebook
        </a>
      </div>
      <div class="footer-right" style="margin-bottom: 20px;">
        <h3 style="color: white;">Location</h3>
        <i class="fas fa-map-marker-alt" style="margin-right: 8px;"></i>Los Angeles, USA
      </div>
    </div>
    <div class="footer-bottom" style="text-align: center; margin-top: 20px; font-size: 0.9rem; color: #ccc;">
      © 2025 Georgian Success in America. All rights reserved.
    </div>
  </footer>

</body>
</html>
